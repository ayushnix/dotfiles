# ~/.bash_profile

# source ~/.bashrc if it exists
if [[ -f "$HOME"/.bashrc ]]; then
  . "$HOME"/.bashrc
fi

# add ~/.local/bin to PATH if it exists
if [ -d "$HOME/.local/bin" ]; then
  PATH="$HOME/.local/bin:$PATH"
fi

# fix bash history maintenance
export HISTCONTROL=ignoreboth:erasedups
export HISTFILESIZE=-1
export HISTSIZE=-1
export HISTTIMEFORMAT="%F %T: "

# XDG configuration
export XDG_CONFIG_HOME="$HOME/.config"
export XDG_CACHE_HOME="$HOME/.cache"
export XDG_DATA_HOME="$HOME/.local/share"
export XDG_STATE_HOME="$HOME/.local/state"

# user specific environment variables
export EDITOR=nvim
export LESS="-iFXR"
export LESSSECURE=1
export LIBVA_DRIVER_NAME=radeonsi
export SSH_AUTH_SOCK="$XDG_RUNTIME_DIR/ssh-agent.socket"
export WG_COLOR_MODE=always
export WG_HIDE_KEYS=always
export PASSWORD_STORE_DIR="$XDG_DATA_HOME/.password-store"
export PASSWORD_STORE_CLIP_TIME=10
export PASSWORD_STORE_ENABLE_EXTENSIONS=true
export GPG_TTY="$(tty)"
BEMENU_OPTIONS=("-i -l 10 -w --scrollbar=autohide -n --fn 'SF Mono 16' \
                 --nb '#1C1E24' --nf '#ABB2BF' --tb '#1C1E24' --tf '#ABB2BF' \
                 --fb '#1C1E24' --ff '#ABB2BF' --hf '#ABB2BF' --hb '#3E4451' \
                 --sb '#1C1E24' --sf '#61AFEF' --scb '#1C1E24' --scf '#61AFEF'")
export BEMENU_OPTS="${BEMENU_OPTIONS[*]}"

# start sway automatically after logging in
if [[ -z "${DISPLAY}" ]] && [[ "$(tty)" == "/dev/tty1" ]]; then
  export QT_QPA_PLATFORM=wayland
  export QT_QPA_PLATFORMTHEME=qt5ct
  export _JAVA_AWT_WM_NONREPARENTING=1
  export MOZ_ENABLE_WAYLAND=1
  export XDG_SESSION_TYPE=wayland
  export XDG_CURRENT_DESKTOP=sway
  # sway spams the journal if xwayland is enabled
  # even if it's disabled, libinput spams the journal saying my system
  # (apparently, it means the compositor) is "too slow"
  exec sway > "$(mktemp)" 2>&1
fi
